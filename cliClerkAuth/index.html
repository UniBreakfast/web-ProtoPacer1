<!DOCTYPE html>
<html>
<head>
  <meta charset=UTF-8>
  <title> Faceless Clerk module Authentification </title>

  <script src=_Commons/JS/f.js>       </script>
  <script src=_Commons/JS/cookies.js> </script>
  <script src=_Commons/JS/hub.js>     </script>

  <script src=Clerk/JS/clerkvars.js> </script>
  <script src=Clerk/JS/clerk.js>     </script>
<!--<script src=cloning.js></script>-->


</head>
<body>
  <center>
    <h2>
      This is a Faceless Clerk module Authentification model without normal browser page interface. <br>
      Use console in Developer Tools (F12)
    </h2>
  </center>



  <script>
    function mySubmit() {
      console.log(window.document.forms[0].elements.login.value);
      return false;
    }

    function addSignInForm(container, formobj, id, cls) {
      let timecls = 't' + (+ new Date());

      f.GET('_Components/FormSignIn/signin.css', css=> {
        css = css.replace('timecls', timecls);
        f.str_to_style(css);
      });

      f.GET('_Components/FormSignIn/signin.htm', htm => {

        if (id) htm = htm.replace('<form ',`<form id="${id}" ` );
        htm = htm.replace('<form ', cls ?
              `<form class="${cls} ${timecls}" ` : `<form class="${timecls}" `);
        if (typeof container == 'string')
          container = document.querySelector(container);
        container.innerHTML += htm;

        if (typeof formobj == 'string') formobj = window[formobj] = {}
        formobj.form = f.byCls(timecls)[0];
        let form = formobj.form, els = form.elements;
        //form.classList.remove(timecls);
        formobj.submit = function login() {
          clerk.SignIn(els.login.value, els.pass.value,
                       msg => (form.children[0].textContent = msg));
          return false;
        }
        form.onsubmit = formobj.submit;
////////////////////////////////////////////////////////////////////////////////

      }, log);
    }
    addSignInForm(document.body, 'myForm');



  </script>


</body>
</html>
